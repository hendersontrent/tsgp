<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tsgp">
<title>Introduction to tsgp â€¢ tsgp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tsgp">
<meta property="og:description" content="tsgp">
<meta property="og:image" content="https://hendersontrent.github.io/tsgp/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tsgp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/tsgp.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hendersontrent/tsgp/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to tsgp</h1>
                        <h4 data-toc-skip class="author">Trent
Henderson</h4>
            
            <h4 data-toc-skip class="date">2024-05-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hendersontrent/tsgp/blob/HEAD/vignettes/tsgp.Rmd" class="external-link"><code>vignettes/tsgp.Rmd</code></a></small>
      <div class="d-none name"><code>tsgp.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hendersontrent.github.io/tsgp/">tsgp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p><code>tsgp</code> is a lightweight package for modelling univariate
time-series data with Gaussian processes (GP). It is important to
remember that using a GP for time series basically converts the problem
from one of modelling a <em>generative process</em> (e.g., if we used an
<a href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" class="external-link">ARIMA</a>
model) to that of essentially a curve-fitting exercise. GPs are a <a href="https://en.wikipedia.org/wiki/Bayesian_statistics" class="external-link">Bayesian</a>
method, so if you are unfamiliar with Bayesian inference, please go
check out some resources on that, such as <a href="https://www.youtube.com/watch?v=guTdrfycW2Q&amp;list=PLDcUM9US4XdMROZ57-OIRtIK0aOynbgZN&amp;index=4" class="external-link">this
great video</a> by Richard McElreath. Essentially, the key bits to
remember for this post is that in Bayesian inference, we are interested
in the posterior distribution, which is proportional to the product of
the prior (our beliefs about an event before seeing the data) and the
likelihood (the probability of the data given model parameters).</p>
<p>If you would like a deeper treatment of how GPs can model time-series
data, please see <a href="https://hendersontrent.github.io/posts/2024/05/gaussian-process-time-series/" class="external-link">this
post</a>.</p>
</div>
<div class="section level2">
<h2 id="generating-some-data">Generating some data<a class="anchor" aria-label="anchor" href="#generating-some-data"></a>
</h2>
<p>We are going to simulate some time series data with temporal dynamics
that are commonly encountered in applied settings. Specifically, we are
going to generate a noisy sine wave (i.e., to emulate periodic or
seasonal data) with a linearly increasing trend:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">trend</span> <span class="op">&lt;-</span> <span class="fl">0.08</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">+</span> <span class="va">trend</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>timepoint <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Draw plot</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">timepoint</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">timepoint</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Timepoint"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Values"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="package-functionality">Package functionality<a class="anchor" aria-label="anchor" href="#package-functionality"></a>
</h2>
<div class="section level3">
<h3 id="covariance-functions">Covariance functions<a class="anchor" aria-label="anchor" href="#covariance-functions"></a>
</h3>
<p><code>tsgp</code> contains several covariance functions (coded in C++
for efficiency). All of them return an object of class
<code>GPCov</code> (which is just a matrix but with a new inherited
class that allows us to make use of Râ€™s generic functions).</p>
<div class="section level4">
<h4 id="exponentiated-quadratic">Exponentiated quadratic<a class="anchor" aria-label="anchor" href="#exponentiated-quadratic"></a>
</h4>
<p><span class="math display">\[
k(x, x') = \text{exp} \left( -\frac{1}{2\sigma^{2}}||x -
x'||^{2} \right)
\]</span></p>
<p>In <code>tsgp</code>, cov_exp_quad` takes the following
arguments:</p>
<ul>
<li>
<code>xa</code> â€” vector of values</li>
<li>
<code>xb</code> â€” vector of values</li>
<li>
<code>sigma</code> â€” scalar denoting the variance. Defaults to
<code>1</code>
</li>
<li>
<code>l</code> â€” scalar denoting the lengthscale. Defaults to
<code>1</code>
</li>
</ul>
<p>We can produce two types of plots for <code>GPCov</code> objects by
calling the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic. The first is a plot of samples
from the prior distribution, which we specify by setting
<code>type = "prior"</code>, passing in the input vector
(<code>x2</code> in this example), and setting the number of samples to
draw through the argument <code>k</code>. Here is an example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">mat_exp_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cov_exp_quad.html">cov_exp_quad</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">x2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_exp_quad</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"prior"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The second is a plot of the covariance matrix represented as a
heatmap:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_exp_quad</span>, type <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="rational-quadratic">Rational quadratic<a class="anchor" aria-label="anchor" href="#rational-quadratic"></a>
</h4>
<p><span class="math display">\[
k(x, x') = \sigma^{2} \left( 1 + \frac{||x - x'||^{2}}{2\alpha
\mathcal{l}^{2}} \right)^{-\alpha}
\]</span></p>
<p>In <code>tsgp</code>, <code>cov_rat_quad</code> takes the following
arguments:</p>
<ul>
<li>
<code>xa</code> â€” vector of values</li>
<li>
<code>xb</code> â€” vector of values</li>
<li>
<code>sigma</code> â€” scalar denoting the variance. Defaults to
<code>1</code>
</li>
<li>
<code>alpha</code> â€” scalar <span class="math inline">\(&gt;0\)</span> denoting the mixing coefficient.
Defaults to <code>1</code>
</li>
<li>
<code>l</code> â€” scalar denoting the lengthscale. Defaults to
<code>1</code>
</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat_rat_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cov_rat_quad.html">cov_rat_quad</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">x2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_rat_quad</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"prior"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_rat_quad</span>, type <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="periodic">Periodic<a class="anchor" aria-label="anchor" href="#periodic"></a>
</h4>
<p><span class="math display">\[
k(x, x') = \sigma^{2} \text{exp} \left(
-\frac{2}{\mathcal{l}^{2}}\text{sin}^{2} \left( \pi\frac{|x -
x'|}{p} \right) \right)
\]</span></p>
<p>In <code>tsgp</code>, <code>cov_periodic</code> takes the following
arguments:</p>
<ul>
<li>
<code>xa</code> â€” vector of values</li>
<li>
<code>xb</code> â€” vector of values</li>
<li>
<code>sigma</code> â€” scalar denoting the variance. Defaults to
<code>1</code>
</li>
<li>
<code>l</code> â€” scalar denoting the lengthscale. Defaults to
<code>1</code>
</li>
<li>
<code>p</code> â€” scalar denoting the period. Defaults to
<code>1</code>
</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat_periodic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cov_periodic.html">cov_periodic</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">x2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_periodic</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"prior"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_periodic</span>, type <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="linear">Linear<a class="anchor" aria-label="anchor" href="#linear"></a>
</h4>
<p><span class="math display">\[
k(x,x') = \sigma^{2}_{b} + \sigma^{2}_{v} (xâˆ’c)(x'âˆ’c)
\]</span></p>
<p>In <code>tsgp</code>, <code>cov_linear</code> takes the following
arguments:</p>
<ul>
<li>
<code>xa</code> â€” vector of values</li>
<li>
<code>xb</code> â€” vector of values</li>
<li>
<code>sigma_b</code> â€” scalar denoting the constant variance.
Defaults to <code>1</code>
</li>
<li>
<code>sigma_v</code> â€” scalar denoting the constant variance.
Defaults to <code>1</code>
</li>
<li>
<code>c</code> â€” scalar denoting the offset. Defaults to
<code>1</code>
</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cov_linear.html">cov_linear</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">x2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_linear</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"prior"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_linear</span>, type <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="white-noise">White noise<a class="anchor" aria-label="anchor" href="#white-noise"></a>
</h4>
<p><span class="math display">\[
k(x, x') = \sigma^{2}I_{n}
\]</span></p>
<p>In <code>tsgp</code>, noise is handled within the core
<code>GP</code> function since it only applies to the covariance matrix
between observations. The <code>GP</code> function is discussed later in
this vignette.</p>
<p>However, for visual comparison to the other covariance functions,
here is what it looks like:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_noise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">sigma</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="va">sigma</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="va">X</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GPCov"</span>, <span class="st">"matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mat_noise</span> <span class="op">&lt;-</span> <span class="fu">cov_noise</span><span class="op">(</span><span class="va">x2</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_noise</span>, <span class="va">x2</span>, type <span class="op">=</span> <span class="st">"prior"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat_noise</span>, type <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="combining-covariance-functions">Combining covariance functions<a class="anchor" aria-label="anchor" href="#combining-covariance-functions"></a>
</h4>
<p>Often in time-series analysis we need our models to capture multiple
different statistical dynamics simultaneusly, such as trend,
seasonality, and noise. It is quite easy to define a custom composite
kernel function which either sums or multiplies different kernels:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CovSum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xa</span>, <span class="va">xb</span>, <span class="va">sigma_1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">sigma_2</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">l_1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">l_2</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">p</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cov_exp_quad.html">cov_exp_quad</a></span><span class="op">(</span><span class="va">xa</span>, <span class="va">xb</span>, <span class="va">sigma_1</span>, <span class="va">l_1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="../reference/cov_periodic.html">cov_periodic</a></span><span class="op">(</span><span class="va">xa</span>, <span class="va">xb</span>, <span class="va">sigma_2</span>, <span class="va">l_2</span>, <span class="va">p</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="va">X</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GPCov"</span>, <span class="st">"matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<p>The core <code>GP</code> function in <code>tsgp</code> to calculate
the posterior mean vector and covariance matrix. <code>GP</code> returns
an object of class <code>x</code> which is a list of the input data, the
posterior mean vector, and the posterior covariance matrix.
<code>GP</code> takes the following arguments:</p>
<ul>
<li>
<code>x</code> â€” vector of input data</li>
<li>
<code>xprime</code> â€” vector of data points to predict values
for</li>
<li>
<code>y</code> â€” vector of values to learn from</li>
<li>
<code>covfun</code> â€” function specifying the covariance</li>
<li>
<code>noise</code> â€” scalar denoting the noise variance to add to
the <span class="math inline">\((x, x)\)</span> covariance matrix of
observations. Defaults to <code>0</code> for no noise modelling</li>
<li>
<code>...</code> â€” hyperparameters to be passed to
<code>cov_function</code>
</li>
</ul>
<p>Here is an example for a model which predicts values for a set of
uniformally-distributed time points over the <span class="math inline">\([1-100]\)</span> domain:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GP.html">GP</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="va">y</span>, <span class="va">CovSum</span>, noise <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>           sigma_1 <span class="op">=</span> <span class="fl">5</span>, sigma_2 <span class="op">=</span> <span class="fl">1</span>, l_1 <span class="op">=</span> <span class="fl">75</span>, l_2 <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "x"      "xprime" "y"      "mu"     "Sigma"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-visualisation">Model visualisation<a class="anchor" aria-label="anchor" href="#model-visualisation"></a>
</h3>
<p>We can easily visualise draws from the posterior distribution by
calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on a <code>TSGP</code> object. The
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic for <code>TSGP</code> takes only three
arguments:</p>
<ol style="list-style-type: decimal">
<li>
<code>x</code> â€” <code>TSGP</code> model object</li>
<li>
<code>prob</code> â€” desired credible interval probability level.
Defaults to <code>0.95</code> for a <span class="math inline">\(95\%\)</span> credible interval</li>
<li>
<code>draws</code> â€” number of posterior draws to summarise over.
Defaults to <span class="math inline">\(100\)</span>
</li>
</ol>
<p>Here is an example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fl">0.95</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Here is another for a model which predicts for all time points but
with <span class="math inline">\(1000\)</span> draws:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GP.html">GP</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x1</span>, <span class="va">y</span>, <span class="va">CovSum</span>, <span class="fl">0.8</span>,</span>
<span>           sigma_1 <span class="op">=</span> <span class="fl">5</span>, sigma_2 <span class="op">=</span> <span class="fl">1</span>, l_1 <span class="op">=</span> <span class="fl">75</span>, l_2 <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="fl">0.95</span>, <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Need more uncertainty?</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GP.html">GP</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x1</span>, <span class="va">y</span>, <span class="va">CovSum</span>, noise <span class="op">=</span> <span class="fl">1.75</span>,</span>
<span>           sigma_1 <span class="op">=</span> <span class="fl">5</span>, sigma_2 <span class="op">=</span> <span class="fl">1</span>, l_1 <span class="op">=</span> <span class="fl">75</span>, l_2 <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod3</span>, <span class="fl">0.95</span>, <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<p>What about a short-range forecast?</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GP.html">GP</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">101</span><span class="op">:</span><span class="fl">150</span>, <span class="va">y</span>, <span class="va">CovSum</span>, <span class="fl">0.8</span>,</span>
<span>           sigma_1 <span class="op">=</span> <span class="fl">5</span>, sigma_2 <span class="op">=</span> <span class="fl">1</span>, l_1 <span class="op">=</span> <span class="fl">75</span>, l_2 <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod4</span>, <span class="fl">0.95</span>, <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="tsgp_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Trent Henderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
